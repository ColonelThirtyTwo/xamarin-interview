
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	
	<title>Biome Map</title>
	
	<link rel="stylesheet" type="text/css" href="./style.css">
	<link rel="stylesheet" type="text/css" href="./select2.css">
	
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/select2/3.5.2/select2.min.js"></script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js"></script>
</head>
<body>

<noscript>
	<h1>This app requires Javascript!</h1>
</noscript>

<div>
	<input type="text" id="movie-searcher">
</div>

<svg>
</svg>

<script type="text/javascript">
	
	// Movie Selector
	$("#movie-searcher").select2({
		placeholder: "Select a movie",
		minimumInputLength: 4,
		width: "100%",
		ajax: {
			url: "http://www.omdbapi.com/",
			dataType: "json",
			quietMillis: 250,
			cache: true,
			data: function(term, page) {
				return {
					s: term,
				};
			},
			results: function(data, page) {
				// OMDB likes to duplicate titles, so filter those out.
				var added = d3.set();
				var results = [];
				
				for(var i=0; i<data.Search.length; i++) {
					var entry = data.Search[i];
					if(!added.has(entry.Title)) {
						added.add(entry.Title);
						results.push({
							id: entry.Title,
							text: entry.Title + " ("+entry.Year+")",
						});
					}
				}
				
				return {
					results: results,
					more: false,
				};
			},
		}
	});
	
	$("#movie-searcher").on("select2-selecting", function(e) {
		console.log(e);
	});
	
</script>

</body>
</html>
